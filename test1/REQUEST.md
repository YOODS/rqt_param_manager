# rqt_param_manager 設計変更

## 1. 起動
~~~
[ROS_NAMESPACE=test] rqt_param_manager [conf:=<config file>] [dump:=<yaml file>]
~~~
- config fileは項目など設定ファイル。*省略時はカレントの[D|d]efault.pmconfを使う*
- config fileのパラメータ名が **/** 以外で始まるときは、環境変数ROS_NAMESPACEで与えられた名前をその前に結合します。

## 2. Config file
- テキスト形式のファイルにて、１行が表示項目の１行に対応する。
- 項目分類は以下の３種類
  - パラメータ(Number,String,Array??)
  - サービス(std_srvs/Triggerのみ)
  - コメント
  
### 2-1. 数値パラメータの表記  
Config fileでの数値パラメータの記述を下記に例示します。
~~~
"Number:camera/ExposureTime","露光時間(usec)"
~~~
このときの画面表示は以下のようになります。

|第1列|第2列|第3列|
:----|:----|:----
|露光時間(usec)|10000|---|

第2列を編集中は文字色が**赤**となり、Enterキーが押されるかフォーカスが外され、値の書込が完了すると黒に戻ります。

また**Number:**が省略されている時は数値パラメータと解釈されます。よって下記は同じ結果となります。
~~~
"camera/ExposureTime","露光時間(usec)"
~~~
数値パラメータには、将来的には、**表示ゲイン、表示フォーマット、入力上下限値**が追加される予定です。

### 2-2. 文字パラメータの表記  
Config fileでの文字パラメータの記述を下記に例示します。
~~~
"Text:camera/ID","カメラID"
~~~
このときの画面表示は以下のようになります。

|第1列|第2列|第3列|
:----|:----|:----
|カメラID|YOODS|---|

### 2-3. ファイルパラメータの表記(*この機能は2018.12時点では未実装でよい*)  
ファイルパラメータは文字パラメータに分類されますが、入力手段がキー以外にファイルリストから選べるようになったものです。
Config fileでのファイルパラメータの記述を下記に例示します。
~~~
"File:solver/model_name","モデルデータファイル","data/*.ply"
~~~
このときの画面表示は以下のようになります。

|第1列|第2列|第3列|
:----|:----|:----
|モデルデータファイル|model1.ply|［一覧］ボタン|

［一覧］ボタンを押すと、ダイアログが開き、"data/*.ply"規則に合致するファイル一覧から入力文字を選択できます。

### 2-4. コメントの表記  
コメントはUIをわかりやすくするもので、［保存］ボタン操作の対象外です。  
Config fileでのコメント行の記述を下記に例示します。
~~~
"Rem:位相シフト用パラメータ"
~~~
このときの画面表示は以下のようになります。

<table border>
<tr><th>位相シフト用パラメータ
</table>

### 2-5. トリガーの表記
トリガーは、パラメータではなくサービスコール(std_srvs/Trigger)を発生させます。
Config fileでのトリガーの記述を下記に例示します。
~~~
"Trigger:pshift_genpc","3D撮像"
~~~
このときの画面表示は以下のようになります。

|第1列|第2列|第3列|
:----|:----|:----
|3D撮像|---|---|

サービスコールの結果はアラートに表示されます。

|処理結果|
:----:
|成否:OK(True)|
|メッセージ:400000 points scanned|
|Close|

## 3.パラメータの保存  
起動パラメータにdump:=...にてyamlファイルが指定されているときは、［保存］ボタンの操作により現在のパラメータを当該ファイルに書き込みます。現行仕様との差異は以下
- 保存先に存在しないパラメータは追加しない

